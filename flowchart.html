<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borderellen Converter - Processchema</title>
    <script src="src/lib/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #00bcd4;
            border-bottom: 3px solid #00bcd4;
            padding-bottom: 10px;
            text-align: center;
        }
        .tab-container {
            margin: 20px 0;
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 20px;
        }
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            border-bottom: 3px solid transparent;
            margin-right: 5px;
            border-radius: 4px 4px 0 0;
            font-weight: 500;
            transition: all 0.3s;
        }
        .tab:hover {
            background: #e9ecef;
        }
        .tab.active {
            background: white;
            border-bottom: 3px solid #00bcd4;
            color: #00bcd4;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .flowchart-container {
            margin: 20px 0;
            text-align: center;
        }
        .description {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .legend-item {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            border-left: 4px solid #00bcd4;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
        }
        .success { background-color: #28a745; }
        .warning { background-color: #ffc107; }
        .error { background-color: #dc3545; }
        .process { background-color: #007bff; }
        .decision { background-color: #6f42c1; }
        .code-section {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #00bcd4;
        }
        .step-box {
            margin: 15px 0;
            padding: 10px;
            background: #e8f5e8;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš¡ Borderellen Converter - Processchema</h1>

        <div class="description">
            <h3>Overzicht van het Verwerkingsproces (v0.81 - Met Email & Header Selectie)</h3>
            <p>Dit schema toont de volledige workflow van het uploaden van borderelbestanden tot het downloaden van gestandaardiseerde data. Het proces gebruikt een intelligente 3-flow architectuur met geoptimaliseerde pattern analysis, handmatige header/footer selectie en email functionaliteit voor ontbrekende data.</p>
        </div>

        <div class="tab-container">
            <div class="tabs">
                <button class="tab active" onclick="showTab('main')">Hoofdproces</button>
                <button class="tab" onclick="showTab('auto-skip')">Auto-Skip Rules</button>
                <button class="tab" onclick="showTab('auto-mapping')">Auto-Mapping</button>
                <button class="tab" onclick="showTab('header-selection')">Header Selectie</button>
                <button class="tab" onclick="showTab('email-flow')">Email Functie</button>
            </div>

            <div id="main" class="tab-content active">
                <div class="flowchart-container">
                    <div id="flowchart"></div>
                </div>
            </div>

            <div id="auto-skip" class="tab-content">
                <div class="flowchart-container">
                    <div id="flowchart-autoskip"></div>
                </div>
            </div>

            <div id="auto-mapping" class="tab-content">
                <div class="flowchart-container">
                    <div id="flowchart-automapping"></div>
                </div>
            </div>

            <div id="header-selection" class="tab-content">
                <div class="description">
                    <h3>Handmatige Header/Footer Selectie</h3>
                    <p>Voor complexe Excel bestanden met extra rijen (logo's, samenvattingen) kan de gebruiker handmatig aangeven waar de data begint en eindigt.</p>
                </div>
                <div class="flowchart-container">
                    <div id="flowchart-header"></div>
                </div>
            </div>

            <div id="email-flow" class="tab-content">
                <div class="description">
                    <h3>Email Functionaliteit met Excel Bijlage</h3>
                    <p>Wanneer verplichte velden ontbreken in de verwerkte data, kan automatisch een email worden gegenereerd naar de contactpersoon met een Excel bijlage.</p>
                </div>
                <div class="flowchart-container">
                    <div id="flowchart-email"></div>
                </div>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color success"></div>
                <span><strong>Succesvol:</strong> Automatische verwerking gelukt</span>
            </div>
            <div class="legend-item">
                <div class="legend-color warning"></div>
                <span><strong>Handmatig:</strong> Gebruikersinteractie vereist</span>
            </div>
            <div class="legend-item">
                <div class="legend-color error"></div>
                <span><strong>Probleem:</strong> Fout of onbekend formaat</span>
            </div>
            <div class="legend-item">
                <div class="legend-color process"></div>
                <span><strong>Proces:</strong> Automatische verwerking</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #90ee90;"></div>
                <span><strong>FLOW 1:</strong> Built-in parsers (AON/VGA/BCI/Voogt)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #ffa500;"></div>
                <span><strong>FLOW 2:</strong> Custom templates (keyword-matched)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #ff6b6b;"></div>
                <span><strong>FLOW 3:</strong> Onbekend formaat (pattern analysis)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4ecdc4;"></div>
                <span><strong>Geoptimaliseerd:</strong> Gecachte pattern analysis</span>
            </div>
        </div>

        <div class="description">
            <h3>Nieuwe Functionaliteiten v0.81</h3>
            <div class="code-section">
                <h4>Handmatige Header/Footer Selectie</h4>
                <p>Voor Excel bestanden met complexe structuren (logo's, meerdere header-rijen, footers) kan de gebruiker handmatig de data-range selecteren. Dit zorgt voor correcte data extractie wanneer automatische detectie niet het gewenste resultaat geeft.</p>
            </div>
            <div class="code-section">
                <h4>Email Functionaliteit met Excel Bijlage</h4>
                <p>Wanneer verplichte velden ontbreken in de verwerkte data, kan automatisch een email worden gegenereerd naar de contactpersoon met:</p>
                <ul>
                    <li>Overzicht van ontbrekende velden per bestand</li>
                    <li>Excel bijlage met kleurcodering van ontbrekende data</li>
                    <li>Contactpersonen beheer voor snelle selectie</li>
                    <li>Automatische download naar voorkeursmap</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            flowchart: {
                htmlLabels: true,
                curve: 'basis'
            }
        });

        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        const flowchartDefinition = `
        flowchart TD
            Start([ğŸš€ App Opstarten]) --> Template{Template<br/>Beschikbaar?}

            Template -->|Ja| UploadTab[ğŸ“ Navigeer naar<br/>Upload Files Tab]
            Template -->|Nee| SelectTemplate[ğŸ“‹ Selecteer Template<br/>in Templates Tab]
            SelectTemplate --> UploadTab

            UploadTab --> Upload[ğŸ“¤ Gebruiker Upload<br/>Bestanden]
            Upload --> DetectType{ğŸ” Detecteer<br/>Bestandstype}

            DetectType -->|AON/VGA/BCI/Voogt| BuiltInFlow[ğŸŸ¢ FLOW 1: Built-in Parser<br/>Directe Verwerking]
            DetectType -->|Keyword Match| CustomFlow[ğŸŸ¡ FLOW 2: Custom Template<br/>Auto-toegepast via Keyword]
            DetectType -->|Onbekend| UnknownFlow[ğŸ”´ FLOW 3: Onbekend Formaat<br/>Pattern Analysis]

            BuiltInFlow --> AONProcess[âš™ï¸ AON Parser]
            BuiltInFlow --> VGAProcess[âš™ï¸ VGA Parser]
            BuiltInFlow --> BCIProcess[âš™ï¸ BCI Parser]
            BuiltInFlow --> VoogtProcess[âš™ï¸ Voogt Parser]

            CustomFlow --> LoadTemplate[ğŸ“‹ Laad Unified File Mapping<br/>met parsingConfig & columnMapping]
            LoadTemplate --> ValidateCustom{âœ… Template<br/>Validatie}

            UnknownFlow --> PatternAnalysis[ğŸ” DataPatternAnalyzer<br/>Eenmalige 2D Density Analysis]
            PatternAnalysis --> CacheAnalysis[ğŸ’¾ Cache Analysis in<br/>fileData.patternAnalysis]
            CacheAnalysis --> ShowOptions[â“ Toon Template Selectie<br/>of Maak Nieuwe Mapping]

            ShowOptions --> UserChoice{ğŸ‘¤ Gebruiker<br/>Keuze}
            UserChoice -->|Selecteer Template| SelectExisting[ğŸ“‹ Selecteer Bestaande<br/>Template uit Dropdown]
            UserChoice -->|Maak Mapping| BrokerMapping[ğŸ—ºï¸ Navigeer naar<br/>Broker Mapping Tab]

            SelectExisting --> ApplyExistingTemplate[ğŸ”„ Pas Bestaande Template toe<br/>met parsingConfig]
            BrokerMapping --> UseCache[âš¡ Gebruik Cached Analysis<br/>voor Source Columns]
            UseCache --> CreateMapping[ğŸ‘¤ Gebruiker Maakt<br/>Kolom Mapping met Skip Rules]

            AONProcess --> ValidateAON{âœ… Data<br/>Validatie}
            VGAProcess --> ValidateVGA{âœ… Data<br/>Validatie}
            BCIProcess --> ValidateBCI{âœ… Data<br/>Validatie}
            VoogtProcess --> ValidateVoogt{âœ… Data<br/>Validatie}

            ValidateCustom --> CustomSuccess[âœ… Auto-verwerkt met<br/>Keyword Template]
            ApplyExistingTemplate --> ExistingSuccess[âœ… Verwerkt met<br/>Bestaande Template]

            CreateMapping --> SaveTemplate{ğŸ’¾ Template<br/>Opslaan?}
            SaveTemplate -->|Ja| SaveUnifiedMapping[ğŸ’¾ Unified File Mapping<br/>Opgeslagen in fileMappings]
            SaveTemplate -->|Nee| ApplyMapping[ğŸ”„ Mapping Toepassen<br/>met Skip Rules]
            SaveUnifiedMapping --> ApplyMapping
            ApplyMapping --> PreviewMapping[ğŸ‘ï¸ Preview Resultaten<br/>met Cached Analysis]

            ValidateAON -->|Success| SuccessData[âœ… Data Succesvol<br/>Verwerkt]
            ValidateVGA -->|Success| SuccessData
            ValidateBCI -->|Success| SuccessData
            ValidateVoogt -->|Success| SuccessData
            CustomSuccess --> SuccessData
            ExistingSuccess --> SuccessData

            ValidateAON -->|Fout| ErrorData[âŒ Verwerkingsfout]
            ValidateVGA -->|Fout| ErrorData
            ValidateBCI -->|Fout| ErrorData
            ValidateVoogt -->|Fout| ErrorData
            ValidateCustom -->|Fout| ErrorData

            ErrorData --> BrokerMapping
            PreviewMapping --> ManualResults[ğŸ“ˆ Handmatig naar<br/>Results Tab]

            SuccessData --> CheckAllFiles{ğŸ“Š Alle Bestanden<br/>Succesvol?}
            CheckAllFiles -->|Ja| AutoResults[ğŸ¯ Auto-navigatie naar<br/>Results Tab]
            CheckAllFiles -->|Nee| AutoBrokerMapping[ğŸ¯ Auto-navigatie naar<br/>Broker Mapping Tab]

            AutoResults --> ShowResults[ğŸ“ˆ Toon Gecombineerde<br/>Resultaten]
            AutoBrokerMapping --> BrokerMapping
            ManualResults --> ShowResults

            ShowResults --> DisplayData[ğŸ“‹ Toon Sample Data<br/>3 Eerste + 3 Laatste<br/>per Bestand]
            DisplayData --> SearchFilter[ğŸ” Zoek & Filter<br/>Functionaliteit]
            SearchFilter --> ExportOptions{ğŸ“¥ Export<br/>Opties}

            ExportOptions -->|Excel| DownloadExcel[ğŸ“Š Download Excel<br/>Alle Data]
            ExportOptions -->|JSON| DownloadJSON[ğŸ“„ Download JSON<br/>Alle Data]

            DownloadExcel --> PreferredFolder{ğŸ“ Voorkeursmap<br/>Ingesteld?}
            DownloadJSON --> PreferredFolder

            PreferredFolder -->|Ja| FolderPicker[ğŸ“‚ Windows Explorer<br/>Opent in Voorkeursmap]
            PreferredFolder -->|Nee| DefaultDownload[â¬‡ï¸ Standaard Browser<br/>Download]

            FolderPicker --> SaveFile[ğŸ’¾ Bestand Opgeslagen<br/>op Gekozen Locatie]
            DefaultDownload --> SaveFile
            SaveFile --> Complete([ğŸ‰ Proces Voltooid])

            %% Styling
            classDef successClass fill:#d4edda,stroke:#28a745,stroke-width:2px,color:#155724
            classDef warningClass fill:#fff3cd,stroke:#ffc107,stroke-width:2px,color:#856404
            classDef errorClass fill:#f8d7da,stroke:#dc3545,stroke-width:2px,color:#721c24
            classDef processClass fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px,color:#0c5460
            classDef decisionClass fill:#e2e3f0,stroke:#6f42c1,stroke-width:2px,color:#493176
            classDef flow1Class fill:#90ee90,stroke:#28a745,stroke-width:3px,color:#155724
            classDef flow2Class fill:#ffa500,stroke:#ff8c00,stroke-width:3px,color:#b8860b
            classDef flow3Class fill:#ff6b6b,stroke:#dc3545,stroke-width:3px,color:#721c24
            classDef cacheClass fill:#4ecdc4,stroke:#17a2b8,stroke-width:2px,color:#0c5460

            class SuccessData,CustomSuccess,ExistingSuccess,AutoResults,ShowResults,SaveFile,Complete successClass
            class CreateMapping,SaveTemplate,BrokerMapping,PreviewMapping,ManualResults,FolderPicker,ShowOptions,UserChoice warningClass
            class ErrorData,UnknownFlow,AutoBrokerMapping errorClass
            class Upload,DetectType,ApplyMapping,DisplayData,SearchFilter,DownloadExcel,DownloadJSON,LoadTemplate,ApplyExistingTemplate processClass
            class Template,ValidateAON,ValidateVGA,ValidateBCI,ValidateVoogt,ValidateCustom,CheckAllFiles,ExportOptions,PreferredFolder decisionClass
            class BuiltInFlow,AONProcess,VGAProcess,BCIProcess,VoogtProcess flow1Class
            class CustomFlow flow2Class
            class PatternAnalysis,UseCache,CacheAnalysis cacheClass
            class SaveUnifiedMapping flow3Class
        `;

        // Header Selection Flow
        const headerSelectionFlow = `
        flowchart TD
            Start([Complex Excel File Uploaded]) --> AutoDetect[ğŸ” Automatic Pattern Analysis]
            AutoDetect --> CheckResult{Analysis<br/>Correct?}

            CheckResult -->|Ja| Continue[âœ… Continue with Processing]
            CheckResult -->|Nee| ManualButton[ğŸ‘¤ User Clicks<br/>Select Headers/Footers Manually]

            ManualButton --> ShowPreview[ğŸ“‹ Show Excel Preview<br/>with Row Numbers]
            ShowPreview --> UserSelect[ğŸ‘¤ User Selects<br/>Start & End Rows]

            UserSelect --> ValidateRange{Valid<br/>Range?}
            ValidateRange -->|Nee| ErrorMsg[âŒ Show Error Message]
            ErrorMsg --> UserSelect

            ValidateRange -->|Ja| ApplySelection[ğŸ”„ Apply Row Selection]
            ApplySelection --> UpdateConfig[ğŸ’¾ Update parsingConfig<br/>skipRows & Data Range]
            UpdateConfig --> ReloadColumns[ğŸ“Š Reload Source Columns<br/>from Selected Range]
            ReloadColumns --> ShowMapping[ğŸ—ºï¸ Show Column Mapping<br/>with Correct Data]
            ShowMapping --> ProcessFile[âš™ï¸ Process File<br/>with Custom Range]
            ProcessFile --> Success([âœ… Data Correctly Extracted])

            style Start fill:#e1f5fe
            style ManualButton fill:#fff3cd,stroke:#ffc107
            style ShowPreview fill:#d1ecf1,stroke:#17a2b8
            style ApplySelection fill:#4ecdc4,stroke:#17a2b8
            style Success fill:#d4edda,stroke:#28a745
            style ErrorMsg fill:#f8d7da,stroke:#dc3545
        `;

        // Email Flow
        const emailFlow = `
        flowchart TD
            Start([Data Processed with Missing Fields]) --> CheckMissing{Missing<br/>Required<br/>Fields?}

            CheckMissing -->|Nee| Complete([âœ… Process Complete])
            CheckMissing -->|Ja| ShowButton[ğŸ“§ Show Generate Email Button]

            ShowButton --> UserClick[ğŸ‘¤ User Clicks<br/>Generate Missing Data Email]
            UserClick --> AnalyzeData[ğŸ” Analyze Missing Fields<br/>per File]

            AnalyzeData --> ShowModal[ğŸ“ Show Email Modal]
            ShowModal --> ContactChoice{Contact<br/>Selection}

            ContactChoice -->|Select Existing| LoadContact[ğŸ“‹ Load Contact from List]
            ContactChoice -->|Add New| EnterContact[âœï¸ Enter Name & Email]

            LoadContact --> ValidateContact{Valid<br/>Contact?}
            EnterContact --> ValidateContact

            ValidateContact -->|Nee| ErrorMsg[âŒ Show Error]
            ErrorMsg --> ShowModal

            ValidateContact -->|Ja| GenerateEmail[ğŸ“§ Generate Email Body<br/>with Missing Fields List]
            GenerateEmail --> CreateExcel[ğŸ“Š Create Excel Attachment<br/>with Color Coding]

            CreateExcel --> DownloadExcel[â¬‡ï¸ Download Excel File<br/>to Preferred Folder]
            DownloadExcel --> OpenMailto[ğŸ“¬ Open mailto: Link<br/>with Pre-filled Content]

            OpenMailto --> UserSend[ğŸ‘¤ User Sends Email<br/>from Email Client]
            UserSend --> SaveContact{Save<br/>Contact?}

            SaveContact -->|Ja| StoreContact[ğŸ’¾ Save to brokerContacts]
            SaveContact -->|Nee| Done([âœ… Email Ready to Send])
            StoreContact --> Done

            style Start fill:#e1f5fe
            style ShowButton fill:#fff3cd,stroke:#ffc107
            style AnalyzeData fill:#d1ecf1,stroke:#17a2b8
            style CreateExcel fill:#4ecdc4,stroke:#17a2b8
            style OpenMailto fill:#90ee90,stroke:#28a745
            style Done fill:#d4edda,stroke:#28a745
            style ErrorMsg fill:#f8d7da,stroke:#dc3545
        `;

        // Auto-Skip Flow from auto-skip-flowchart.html
        const autoSkipFlow = `
        flowchart TD
            A["User Uploads File"] --> B{"File Type?"}
            B -->|Excel| C["addFileToTable()"]
            B -->|PDF| D["Mark as PDF - Manual Required"]
            C --> E["detectBrokerType(filename)<br/>ğŸ” Smart 3-Path Detection"]
            E --> F1{Built-in<br/>Parser?}
            E --> F2{Keyword<br/>Match?}
            E --> F3{Unknown<br/>Format?}
            F1 -->|Yes| G1["ğŸŸ¢ FLOW 1: Built-in Parser<br/>AON/VGA/BCI/Voogt<br/>âœ… No Analysis Needed"]
            F2 -->|Yes| G2["ğŸŸ¡ FLOW 2: Keyword-Matched Custom<br/>ğŸ“‹ Load Unified File Mapping<br/>âš¡ Auto-apply with parsingConfig"]
            F3 -->|Yes| G3["ğŸ”´ FLOW 3: Unknown Format<br/>ğŸ” OPTIMIZED: Run Pattern Analysis ONCE<br/>ğŸ’¾ Cache in fileData.patternAnalysis"]
            G1 --> N1["Direct Processing with Built-in Logic"]
            G2 --> N2["processBrokerFile() with custom type<br/>âœ… Uses saved parsingConfig + columnMapping"]
            G3 --> H3["Cache Analysis Results<br/>ğŸ¯ Available for ALL functions"]
            H3 --> I3["Show Template Options"]
            N1 --> MM3["Update File Status & Navigate to Results"]
            N2 --> MM3

            style F1 fill:#90ee90,stroke:#28a745
            style G1 fill:#90ee90,stroke:#28a745
            style F2 fill:#ffa500,stroke:#ff8c00
            style G2 fill:#ffa500,stroke:#ff8c00
            style F3 fill:#ff6b6b,stroke:#dc3545
            style G3 fill:#ff6b6b,stroke:#dc3545
            style H3 fill:#4ecdc4,stroke:#17a2b8
        `;

        // Auto-Mapping Flow from mapping_flowchart.html
        const autoMappingFlow = `
        flowchart TD
            A["User clicks Auto Map button"] --> B["app.js: generateAutoMapping()"]
            B --> C["Get sourceColumnNames from Excel"]
            B --> D["Get templateColumns from borderellenTemplate"]
            C --> E["AutoMapping.generateMappingSuggestions()"]
            D --> E
            E --> F["Build NÃ—M Confidence Matrix"]
            F --> G["For each source Ã— template pair"]
            G --> H["AutoMapping.calculateColumnMatchConfidence()"]
            H --> I["normalizeString on both names"]
            I --> J{"Are normalized strings identical?"}
            J -->|Yes| K["Return 100.0 - EXACT MATCH"]
            J -->|No| L["Calculate fuzzy scores"]
            L --> M["Character Similarity: Levenshtein Ã— 50"]
            M --> N["Substring Coverage: coverage Ã— 30"]
            N --> O["Word Overlap: overlap Ã— 20"]
            O --> P["Length Penalty: diff Ã— 0.5"]
            P --> Q["Sum scores, cap at 99 max"]
            Q --> R["Store in confidenceMatrix[i][j]"]
            R --> S{"More pairs to calculate?"}
            S -->|Yes| G
            S -->|No| T["performOptimalAssignment()"]
            T --> U["Flatten matrix to allPairs array"]
            U --> V["Sort by confidence DESC"]
            V --> W["Greedy assignment loop"]
            W --> X["Take highest unused pair"]
            X --> Y{"Source and Template both unused?"}
            Y -->|Yes| Z["Assign pair, mark as used"]
            Y -->|No| AA["Skip pair"]
            Z --> BB{"More pairs available?"}
            AA --> BB
            BB -->|Yes| X
            BB -->|No| CC["Filter by threshold >= 30%"]
            CC --> DD["Return final mapping object"]
            DD --> EE["Update UI with results"]

            style K fill:#4caf50,color:#fff
            style Q fill:#ff9800,color:#fff
            style DD fill:#2196f3,color:#fff
        `;

        // Render all flowcharts
        const element = document.getElementById('flowchart');
        mermaid.render('flowchart-svg', flowchartDefinition).then(result => {
            element.innerHTML = result.svg;
        });

        const elementAutoSkip = document.getElementById('flowchart-autoskip');
        mermaid.render('flowchart-autoskip-svg', autoSkipFlow).then(result => {
            elementAutoSkip.innerHTML = result.svg;
        });

        const elementAutoMapping = document.getElementById('flowchart-automapping');
        mermaid.render('flowchart-automapping-svg', autoMappingFlow).then(result => {
            elementAutoMapping.innerHTML = result.svg;
        });

        const elementHeader = document.getElementById('flowchart-header');
        mermaid.render('flowchart-header-svg', headerSelectionFlow).then(result => {
            elementHeader.innerHTML = result.svg;
        });

        const elementEmail = document.getElementById('flowchart-email');
        mermaid.render('flowchart-email-svg', emailFlow).then(result => {
            elementEmail.innerHTML = result.svg;
        });
    </script>
</body>
</html>